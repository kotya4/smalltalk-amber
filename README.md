Здесь находятся все проекты, написанные на Smalltalk (Amber, Squeak, Pharo).

Название дирректории проекта эквивалентно названию проекта. Так как любой проект в Smalltalk'e эквивалентен классу, а название класса должно начинаться с большой буквы, то и все проекты должны называться с большой буквы.

Также стоит учитывать, что Amber автоматически создает приложения с названием, не содержащим в себе символы верхнего регистра где-либо кроме первого символа.

# Amber

Инициализация и запуск сервера Amber:
```sh
mkdir Projectname
cd Projectname
amber init
amber serve
```

Ссылка на репозиторий Amber: https://lolg.it/amber/amber

Деплой: https://github.com/amber-smalltalk/amber/wiki/Deploying-Amber

## Где начинается боль...

В Amber нет дефолтного класса для работы с HTML5 Canvas (не путать с классом HTMLCanvas - это что-то навроде JSX), поэтому необходимо установить дополнительный пакет, который называется Athens. Это пакет для работы с векторной графикой для Pharo, а портированная в Amber версия использует канвас. (Так же я нашел порт библиотеки d3 для вывода SVG графики и threejs для WebGL.)

### Как подключить Athens (tl;dr у меня не получилось)

Для того, чтобы установить пакет, нужно выполнить (из директории проекта):
```sh
bower install "athens=git://github.com/matthias-springer/amber-athens-library.git" --save
```
однако, постойте-ка, bower не сможет установить пакет, т. к. репозитории по адресу https://lolg.it/amber были переименованы, поэтому пакеты бовера, связанные с амбером, ссылаются на несуществующие репы. (Я написал текущему автору амбер, и он сказал, что бовер уже давно не поддерживается.)

Поэтому вместо этого можно сделать вот так:
```sh
npm install https://github.com/matthias-springer/amber-athens-library
```
Таким образом, установленный пакет добавится в "package.json".

Чтобы подключить библиотеку, необходимо выполнить:
```sh
grunt devel
# ИЛИ
grunt deploy # тогда проект будет готов к релизу, все dependences будут запакованы
             # в "the.js" (и "index.html", нужны только эти два файла).
# ИЛИ
grunt # тогда grunt пересоберет все src и libraries (см. "Gruntfile.js", [grunt.initConfig] -> amberc -> all). Кажется, это равносильно команде "grunt default devel".
```
В любом случае, после данной команды в "config.js" появятся все модули с ассоциированными до сорцов путями.

Далее (вроде как) нужно подрубить библиотеки в файлы "devel.js" и/или "deploy.js". Насколько я понял, все, что подключено в deploy, будет подключено и в devel, поэтому дублировать ничего не нужно. Так же, насколько я понял, эти файлы дублируют функционал файла "Gruntfile.js" (например, поле [grunt.initConfig] -> amberc -> all -> libraries). Таким образом, файл "deploy.js" у меня выглядит вот так:
```js
define([
    'amber/deploy',
    'amber-myproject/Myproject', // Класс моего проекта
    'amber-athens/Athens-Amber'  // Подключаемая библиотека
    /*
      "amber-athens" -- это ассоциация директории, описанная в "config.js" после выполнения grunt, где лежат сорцы библиотеки.
      "Athens-Amber" -- это название файла "Athens-Amber.js" (без расширения).
    */
], function (amber) {
    return amber;
});
```
(подробнее тут: http://forum.world.st/How-to-include-external-libraries-td4834010.html)

Кажется, теперь подключенная библиотека должна появиться в Browser Helios'a? Пошел нахуй, js-файлы Athens устарели, и при попытке их подключения сервер (на самом деле клиент, т.к. ошибка появляется в консоли браузера, а не в cli) выкидывает ошибку "TypeError: Cannot read property 'Athens-Amber' of undefined", и это не враньё, потому что у объекта $core в "Athens-Amber.js" действительно отсутствует ключ packages (потому что в новой версии Amber этот ключ называется pakageDependencies или типа того), поэтому тебе нужно скачать репозиторий с athens'ом, собрать его САМОСТОЯТЕЛЬНО, и уже потом закинуть его в виде библиотеки (или сорцов, если лень собирать) в свой проект. (Собрать все же придется, т.к. оказалось, что библиотека устарела, и новый Amber не понимает транслированный js-код.)

Я не смог собрать Athens.

#Пара улучшений для тех кто решил, что ему удобнее писать на Legacy IDE.

Окошко, которое предлагает выбрать IDE, вылазящее каждый раз при обновлении страницы -- это ide-starter-modal ([Projectname]\node_modules\@ambers\ide-starter-modal). Он вызывается из index.html командой
```js
require(["amber-ide-starter-dialog"], function (dlg) {
  dlg.start();
});
```
поэтому, чтобы сразу открывался Legacy IDE, замените вызов "ide-starter-modal" этим кодом:
```js
require('amber/helpers').globals.Browser._open();
```

Как это скажется на деплое, я пока не знаю. (подсказка: хуёво)

***

В дирректории [Projectname]\node_modules\@ambers\contrib-legacy\resources лежит файл "amber.css" -- это стили для контейнера IDE. Можно в конец файла добавить:
```css
#amber {
  height: 600px;
}
```
чтобы изменить дефолтный размер контейнера (тем самым увеличив размер текстареи для кода). Также, я думаю, там все шрифты и т.д.

У меня не работает Ctrl+D (шорткат для DoIt). Вместо выполнения кода он удаляет весь текст из воркспейса. Имплементация шарткатов содержится в методе handleKeyDown класса SourceArea пакета IDE. Я не понимаю, как транслируется инлайн JS, поэтому не могу понять, какой метод там вызывается, поэтому не знаю, как это исправить. Но это баг (воспроизводится по крайней мере в Google Chrome Version 83.0.4103.116).

Кстати смешно, но в package.json IDE в депенденсис лежит "@ambers/helios". (Если что, Гелиос -- это вроде как замена Legacy IDE. (Ну это не удивительно, т.к. амбер был полностью пересобран с помощью новых инструментов (amber init / amber serve), а новые инструменты по дефолту накидывают в проект всякого говна типа Silk'а и Helios'а.) )
